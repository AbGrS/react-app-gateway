(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{23:function(e,t,n){e.exports={row:"login_row__2KzBg",button:"login_button__1mFk-",loginButton:"login_loginButton__2_ulT login_button__1mFk-"}},36:function(e,t,n){e.exports={column:"dashboard_column__t1DRn"}},42:function(e,t,n){},68:function(e,t,n){},69:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(17),o=n.n(c),s=(n(42),n(34)),i=n(25),u=n(9),l=n(3),j=n(14),d=n.n(j),b=n(22),p=n(11),h=n(19),f=n.n(h);function O(e){return"".concat("https://sheltered-mountain-74311.herokuapp.com/").concat("http://35.207.169.147/").concat(e)}function m(e){var t=e.email,n=e.password;return f.a.post(O("auth"),{email:t,password:n})}function x(e){return f.a.defaults.headers.common={Authorization:"Bearer ".concat(e)},f.a.get(O("results"))}var g=Object(p.b)("user/login",function(){var e=Object(b.a)(d.a.mark((function e(t,n){var r,a,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.email,a=t.password,c=n.rejectWithValue,e.prev=2,e.next=5,m({email:r,password:a});case 5:return e.abrupt("return",e.sent);case 8:return e.prev=8,e.t0=e.catch(2),e.abrupt("return",c(e.t0));case 11:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t,n){return e.apply(this,arguments)}}()),v=Object(p.b)("user/fetchResults",function(){var e=Object(b.a)(d.a.mark((function e(t,n){var r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.rejectWithValue,e.prev=1,e.next=4,x(t);case 4:return e.abrupt("return",e.sent);case 7:return e.prev=7,e.t0=e.catch(1),e.abrupt("return",r(e.t0));case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t,n){return e.apply(this,arguments)}}()),k=n(23),w=n.n(k),_="/",y="/login",I="/dashboard",S=n(1);function E(){var e=Object(u.c)((function(e){return e})).user,t=Object(u.b)(),n=Object(r.useState)(""),a=Object(i.a)(n,2),c=a[0],o=a[1],s=Object(r.useState)(""),j=Object(i.a)(s,2),d=j[0],b=j[1];return localStorage.getItem("token")&&!e.tokenExpired?Object(S.jsx)(l.a,{to:I}):Object(S.jsx)("div",{children:Object(S.jsxs)("div",{className:w.a.row,children:[Object(S.jsx)("input",{type:"text",placeholder:"Email",onChange:function(e){return o(e.target.value)}}),Object(S.jsx)("input",{type:"password",placeholder:"Password",onChange:function(e){return b(e.target.value)}}),Object(S.jsx)("button",{className:w.a.loginButton,onClick:function(){t(g({email:c,password:d}))},children:"Login"}),e.error&&"Some Error occurred. Please try again"]})})}var B=n(36),R=n.n(B),F=0;function N(e){var t=Object(u.b)(),n=Object(u.c)((function(e){return e})).user,a=n.results,c=n.tokenExpired,o=n.errorInFetchingResults,s=localStorage.getItem("token");if(Object(r.useEffect)((function(){return clearInterval(F),t(v(s)),F=setInterval((function(){t(v(s))}),3e4),function(){return clearInterval(F)}}),[]),Object(r.useEffect)((function(){if(!s||c)return alert("Seems like your session has expired. Please login again"),Object(S.jsx)(l.a,{to:y})}),[s,c]),!s||c)return Object(S.jsx)(l.a,{to:y});if(!a.length&&!o)return"Fetching Results...";var i=a.filter((function(e){return"finish"===e.event}));return i=i.sort((function(e,t){return e.time-t.time})),Object(S.jsx)("div",{children:Object(S.jsxs)("div",{className:R.a.column,children:[Object(S.jsx)("h1",{children:"Dashboard"}),Object(S.jsxs)("div",{children:[Object(S.jsx)("span",{children:"No."}),Object(S.jsx)("span",{children:"Horse"}),Object(S.jsx)("span",{children:"Time"}),Object(S.jsx)("span",{children:"Event"})]}),i.map((function(e){return Object(S.jsxs)("div",{children:[Object(S.jsx)("span",{children:e.horse.id}),Object(S.jsx)("span",{children:e.horse.name}),Object(S.jsx)("span",{children:"".concat(e.time/1e3,"s")}),Object(S.jsx)("span",{children:e.event})]},e.horse.id+e.time)})),!i.length&&"The race has just begin..."]})})}var C=n(37),L=(n(68),function(){return localStorage.getItem("token")});var W=function(){return Object(S.jsx)("div",{className:"App",children:Object(S.jsx)(C.a,{children:Object(S.jsxs)(l.d,{children:[Object(S.jsx)(l.b,{path:_,exact:!0,render:function(e){return Object(S.jsx)(l.a,{to:{pathname:L()?I:y,state:{token:L()?L():null}}})}}),Object(S.jsx)(l.b,{exact:!0,path:y,component:E}),Object(S.jsx)(l.b,{path:I,exact:!0,render:function(e){return L()?Object(S.jsx)(N,Object(s.a)({},function(e){return e.location.state={token:L()},e}(e))):Object(S.jsx)(l.a,{to:{pathname:y,state:{from:e.location}}})}})]})})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var z,A=n(10),P=Object(p.c)({name:"user",initialState:{isLoading:!0,results:[]},reducers:{},extraReducers:(z={},Object(A.a)(z,g.pending,(function(e){e.isLoading=!0})),Object(A.a)(z,g.fulfilled,(function(e,t){localStorage.setItem("token",t.payload.data.token),e.tokenReceived=t.payload.data.token,e.tokenExpired=!1,e.results=[]})),Object(A.a)(z,g.rejected,(function(e,t){e.isLoading=!1,e.error=!0})),Object(A.a)(z,v.fulfilled,(function(e,t){e.results.push(t.payload.data),e.error=!1})),Object(A.a)(z,v.rejected,(function(e,t){"Access denied"===t.payload.response.data.error?(localStorage.removeItem("token"),e.tokenExpired=!0):e.errorInFetchingResults=!0})),z)}),T=Object(p.a)({reducer:{user:P.reducer},middleware:function(e){return e({serializableCheck:!1})}});o.a.render(Object(S.jsx)(a.a.StrictMode,{children:Object(S.jsx)(u.a,{store:T,children:Object(S.jsx)(W,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[69,1,2]]]);
//# sourceMappingURL=main.8e91263a.chunk.js.map